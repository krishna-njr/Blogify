<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('partials/head.ejs') %>
    <title>Home-page</title>
  </head>
  <body>
    <%- include('partials/nav.ejs') %>

    <div class="container mt-5">
      <h1 class="text-center my-3"><%= blog.title %></h1>
      <img
        src="<%= blog.coverImageUrl %>"
        alt="<%= blog.title %>"
        class="img-fluid mb-3"
        style="max-height: 400px; object-fit: cover"
      />
      <pre class="overflow-y-auto"><%= blog.content %></pre>
    </div>

    <div class="container">
      <img
        src="<%= blog.author.profileImageUrl %>"
        alt="<%= blog.author.username %>"
        style="width: 50px; height: 50px; border-radius: 50%"
      />
      <%= blog.author.username %>
    </div>

    <% if (locals.user) { %>
    <div class="container mt-3">
      <h4>Comments (<%=  comments.length  %>)</h4>
      <form action="/blog/comment/<%= blog._id %>" method="POST">
        <div class="mb-3">
          <textarea
            name="content"
            class="form-control"
            rows="2"
            required
          ></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Add Comment</button>
      </form>
    </div>
    <%}%>   
    <div class="container mt-3">
      <% if (comments && comments.length > 0) { %>
      <% comments.forEach(comment => { %>
        <div class="card mb-2">
          <div class="card-body">
            <pre class="card-text"><%= comment.content %></pre>
            <footer class="blockquote-footer m-2">
              <img
                src="<%= comment.author.profileImageUrl %>"
                alt="<%= comment.author.username %>"
                style="width: 30px; height: 30px; border-radius: 50%"
              />
              <%= comment.author.username %>
              <!-- <span class="text-muted"
                >on <%= new Date(comment.createdAt).toLocaleString() %></span> -->
            </footer>
          </div>
        </div>
      <% }); %>
    <% } %>

    <%- include('partials/script.ejs') %>
  </body>
</html>
